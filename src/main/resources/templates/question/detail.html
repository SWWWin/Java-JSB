<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8" />
    <title th:text="${question.title}">질문 상세</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        body{font-family:system-ui,sans-serif;margin:20px}
        .meta{font-size:12px;color:#666;display:flex;gap:10px;flex-wrap:wrap}
        .section{margin-top:20px}
        .ans{border-top:1px solid #eee;padding:14px 0}
        .content{margin-top:10px}
    </style>
</head>
<body>
<a th:href="@{/questions}">&larr; 목록</a>

<article class="section">
    <h1 th:text="${question.title}">제목</h1>
    <div class="meta">
        <span th:text="${question.categoryName}">카테고리</span>
        <span th:text="${question.author.name}">작성자</span>
        <span th:text="${#temporals.format(question.createdAt,'yyyy.MM.dd HH:mm')}">작성일</span>
        <span th:text="|조회 ${question.viewCount}|">조회 0</span>
    </div>
    <div class="content" th:utext="${question.contentHtml}">본문</div>

    <div th:if="${isQuestionAuthor}" style="margin-top:8px;">
        <a th:href="@{|/questions/${question.id}/edit|}">수정</a>
        <form th:action="@{|/questions/${question.id}|}" method="post" style="display:inline">
            <input type="hidden" name="_method" value="delete" />
            <button type="submit">삭제</button>
        </form>
    </div>
</article>

<section class="section">
    <h2 th:text="|답변 ${#lists.size(answers)}|">답변 0</h2>
    <div th:each="a : ${answers}" class="ans">
        <div class="meta">
            <span th:text="${a.authorName}">작성자</span>
            <span th:text="${#temporals.format(a.createdAt,'yyyy.MM.dd HH:mm')}">날짜</span>
        </div>
        <div class="content" th:utext="${a.contentHtml}">답변 내용</div>
    </div>
</section>

<section class="section" th:if="${isLoggedIn}">
    <h3>답변 작성</h3>
    <form th:action="@{|/questions/${question.id}/answers|}" method="post">
        <textarea name="content" rows="8" placeholder="답변 내용을 입력하세요" style="width:100%;"></textarea>
        <div style="margin-top:8px;">
            <button type="submit">등록</button>
        </div>
    </form>
</section>

<section class="section" th:if="${!isLoggedIn}">
    <a th:href="@{/login}">로그인 후 답변을 작성할 수 있어요</a>
</section>
</body>
</html>