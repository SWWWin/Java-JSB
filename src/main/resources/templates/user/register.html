<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
</head>
<body>
<h1>회원가입</h1>

<form id="signupForm">
    <label for="email">이메일:</label>
    <input type="email" id="email" name="email" required><br>

    <label for="nickname">닉네임:</label>
    <input type="text" id="nickname" name="nickname" required><br>

    <label for="password">비밀번호:</label>
    <input type="password" id="password" name="password" required><br>

    <button type="submit">회원가입</button>
</form>

<div id="signupResult"></div>

<script type="module">
    const form = document.getElementById('signupForm');
    const result = document.getElementById('signupResult');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = form.email.value;
        const nickname = form.nickname.value;
        const password = form.password.value;

        try {
            const response = await fetch('/user/register', { // 회원가입 API URL
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, nickname, password })
            });

            if (response.ok) {
                result.innerText = "회원가입 성공! 로그인 페이지로 이동합니다.";
                setTimeout(() => window.location.href = '/login', 1500);
            } else {
                const error = await response.text();
                result.innerText = `회원가입 실패: ${error}`;
            }
        } catch (err) {
            console.error('에러:', err);
            result.innerText = '서버 오류가 발생했습니다.';
        }
    });
</script>
</body>
</html>
